import sys, os

class Bug:

    def __init__(self,path):
        self.path = path

    def execute(self):
        vbscript = 'dim shell\nSet shell = WScript.CreateObject("WScript.Shell")\nwallpaper = "C:\Users\mypc\Pictures\wallpaper.jpg"\nshell.RegWrite "HKCU\Control Panel\Desktop\Wallpaper", wallpaper\nshell.Run "%windir%\System32\RUNDLL32.EXE user32.dll,UpdatePerUserSystemParameters", 1, True'
        # Junk code from https://superuser.com/questions/1503092/changing-wallpaper-using-vbs-on-windows-10-doesnt-work
        try:
            with open(self.path,'a') as f:
                f.write(".."+vbscript)
                f.close()
            quit("Sucessfully wrote to file, enjoy.")
        except (Exception) as e:
            print(e)
            quit("Could not write to file, please check your path!")

def main():
    if len(sys.argv) != 1:
        quit("Please supply an image path!")
    
    bug = Bug(img_path)
    bug.execute()
    print("Modified "+img_path)

if __name__ == '__main__':
    main()
